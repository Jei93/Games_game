<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Industry Evolution Simulator - Game Dev Tycoon Clone</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            image-rendering: pixelated;
            image-rendering: -moz-crisp-edges;
            image-rendering: crisp-edges;
        }

        :root {
            --bg-dark: #1a1a1a;
            --bg-panel: #2a2a2a;
            --bg-card: #3a3a3a;
            --bg-card-hover: #4a4a4a;
            --pixel-green: #00ff00;
            --pixel-blue: #0088ff;
            --pixel-yellow: #ffff00;
            --pixel-red: #ff0000;
            --pixel-purple: #ff00ff;
            --pixel-orange: #ff8800;
            --pixel-pink: #ff0088;
            --text-primary: #ffffff;
            --text-secondary: #aaaaaa;
            --border: #555555;
        }

        body {
            font-family: 'Press Start 2P', cursive;
            font-size: 10px;
            background: var(--bg-dark);
            color: var(--text-primary);
            overflow: hidden;
            height: 100vh;
            line-height: 1.5;
        }

        /* üéÆ PIXEL ART EFFECTS */
        .pixel-border {
            border: 3px solid var(--border);
            box-shadow: 
                inset -3px -3px 0 0 #1a1a1a,
                inset 3px 3px 0 0 #5a5a5a;
        }

        .pixel-button {
            background: var(--border);
            border: none;
            color: var(--text-primary);
            padding: 8px 12px;
            cursor: pointer;
            position: relative;
            transition: all 0.1s;
            font-family: 'Press Start 2P', cursive;
            font-size: 9px;
        }

        .pixel-button:hover {
            background: var(--pixel-blue);
            color: var(--bg-dark);
        }

        .pixel-button:active {
            transform: scale(0.95);
        }

        .pixel-bar {
            height: 16px;
            background: var(--bg-panel);
            border: 2px solid var(--border);
            position: relative;
            overflow: hidden;
        }

        .pixel-fill {
            height: 100%;
            background: var(--pixel-green);
            transition: width 0.5s;
            image-rendering: pixelated;
        }

        /* üì∫ GAME LAYOUT */
        .game-container {
            display: grid;
            grid-template-columns: 260px 1fr 300px;
            grid-template-rows: 100%;
            height: 100vh;
            gap: 10px;
            padding: 10px;
        }

        .sidebar, .main-area, .event-panel {
            background: var(--bg-panel);
            border: 3px solid var(--border);
            overflow-y: auto;
            position: relative;
        }

        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 10px;
            padding: 10px;
        }

        .main-area {
            padding: 15px;
        }

        .event-panel {
            padding: 10px;
        }

        /* üè¢ STUDIO INFO */
        .studio-banner {
            background: var(--pixel-purple);
            color: var(--bg-dark);
            padding: 10px;
            text-align: center;
            margin-bottom: 10px;
            font-size: 11px;
        }

        .resource-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .resource-label {
            color: var(--pixel-yellow);
        }

        .resource-value {
            color: var(--pixel-green);
        }

        /* üìä STATS BOXES */
        .stat-box {
            background: var(--bg-card);
            border: 2px solid var(--border);
            padding: 8px;
            margin-bottom: 8px;
            text-align: center;
        }

        .stat-box:hover {
            background: var(--bg-card-hover);
        }

        .stat-title {
            color: var(--text-secondary);
            font-size: 8px;
        }

        .stat-value {
            color: var(--pixel-green);
            font-size: 11px;
            margin-top: 4px;
        }

        /* üéÆ GAME CARDS */
        .game-card {
            background: var(--bg-card);
            border: 3px solid var(--border);
            padding: 12px;
            margin-bottom: 12px;
            position: relative;
        }

        .game-card-title {
            color: var(--pixel-blue);
            font-size: 11px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .option-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 6px;
            margin-top: 8px;
        }

        .option-button {
            background: var(--bg-panel);
            border: 2px solid var(--border);
            color: var(--text-primary);
            padding: 8px;
            cursor: pointer;
            text-align: center;
            font-size: 8px;
            transition: all 0.1s;
        }

        .option-button:hover {
            border-color: var(--pixel-blue);
            background: var(--pixel-blue);
            color: var(--bg-dark);
        }

        .option-button.selected {
            border-color: var(--pixel-green);
            background: var(--pixel-green);
            color: var(--bg-dark);
        }

        /* üìú EVENT LOG */
        .event-item {
            background: var(--bg-card);
            border: 2px solid var(--border);
            padding: 6px;
            margin-bottom: 6px;
            font-size: 8px;
            line-height: 1.4;
        }

        .event-item.danger { border-color: var(--pixel-red); }
        .event-item.success { border-color: var(--pixel-green); }
        .event-item.warning { border-color: var(--pixel-yellow); }

        .event-header {
            color: var(--text-secondary);
            margin-bottom: 4px;
        }

        /* üéØ MODAL */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 1000;
            place-items: center;
        }

        .modal.active {
            display: grid;
        }

        .modal-content {
            background: var(--bg-panel);
            border: 4px solid var(--pixel-blue);
            padding: 20px;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--border);
        }

        .modal-title {
            color: var(--pixel-blue);
            font-size: 11px;
        }

        .close-button {
            color: var(--pixel-red);
            cursor: pointer;
            font-size: 11px;
        }

        .modal-section {
            margin-bottom: 15px;
        }

        .modal-section h4 {
            color: var(--pixel-yellow);
            margin-bottom: 8px;
            font-size: 9px;
        }

        .genre-grid, .theme-grid, .platform-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 5px;
        }

        /* üìà REVIEW SCREEN */
        .review-modal {
            text-align: center;
        }

        .review-score {
            font-size: 48px;
            color: var(--pixel-green);
            margin: 20px 0;
            text-shadow: 3px 3px 0 var(--bg-dark);
        }

        .review-stars {
            font-size: 24px;
            color: var(--pixel-yellow);
            margin-bottom: 20px;
        }

        .review-comments {
            background: var(--bg-card);
            border: 2px solid var(--border);
            padding: 10px;
            margin: 15px 0;
            font-size: 9px;
            line-height: 1.5;
        }

        /* üíæ SAVE/LOAD */
        .save-indicator {
            position: fixed;
            bottom: 10px;
            right: 10px;
            background: var(--pixel-green);
            color: var(--bg-dark);
            padding: 5px 10px;
            font-size: 8px;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .save-indicator.show {
            opacity: 1;
        }

        /* üéâ ACHIEVEMENT */
        .achievement-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            background: var(--pixel-purple);
            color: var(--text-primary);
            border: 4px solid var(--pixel-yellow);
            padding: 20px 40px;
            z-index: 2000;
            transition: transform 0.3s;
            text-align: center;
        }

        .achievement-popup.active {
            transform: translate(-50%, -50%) scale(1);
        }

        .achievement-title {
            font-size: 11px;
            margin-bottom: 5px;
        }

        .achievement-desc {
            font-size: 8px;
            color: var(--text-secondary);
        }
    </style>
</head>
<body>
    <div class="game-container">
        <!-- üéÆ SIDEBAR - RESOURCES -->
        <aside class="sidebar">
            <div class="studio-banner">
                üéÆ GARAGE STUDIOS üéÆ
                <div style="font-size: 8px; margin-top: 5px;">LEVEL 1 - GARAGE</div>
            </div>

            <div class="stat-box">
                <div class="stat-title">üí∞ CASH</div>
                <div class="stat-value" id="cash">$500K</div>
                <div class="pixel-bar">
                    <div class="pixel-fill cash-fill" style="width: 50%"></div>
                </div>
            </div>

            <div class="stat-box">
                <div class="stat-title">üë• TEAM</div>
                <div class="stat-value" id="team">15 / 50</div>
                <div class="pixel-bar">
                    <div class="pixel-fill team-fill" style="width: 30%"></div>
                </div>
            </div>

            <div class="stat-box">
                <div class="stat-title">‚≠ê REPUTATION</div>
                <div class="stat-value" id="reputation">65%</div>
                <div class="pixel-bar">
                    <div class="pixel-fill rep-fill" style="width: 65%"></div>
                </div>
            </div>

            <div class="stat-box">
                <div class="stat-title">üî• HYPE</div>
                <div class="stat-value" id="hype">30%</div>
                <div class="pixel-bar">
                    <div class="pixel-fill hype-fill" style="width: 30%"></div>
                </div>
            </div>

            <div style="margin-top: 20px;">
                <button class="pixel-button" style="width: 100%; margin-bottom: 5px;" onclick="hireStaff()">
                    üíº HIRE STAFF
                </button>
                <button class="pixel-button" style="width: 100%; margin-bottom: 5px;" onclick="investMarketing()">
                    üì¢ MARKETING
                </button>
                <button class="pixel-button" style="width: 100%; margin-bottom: 5px;" onclick="researchTech()">
                    üî¨ R&D
                </button>
                <button class="pixel-button" style="width: 100%;" onclick="moveOffice()">
                    üè¢ MOVE OFFICE
                </button>
            </div>

            <div class="stat-box" style="margin-top: 20px;">
                <div class="stat-title">GAMES RELEASED</div>
                <div class="stat-value" id="gamesReleased">0</div>
            </div>

            <div class="stat-box">
                <div class="stat-title">AVG SCORE</div>
                <div class="stat-value" id="avgScore">‚Äî</div>
            </div>

            <div class="stat-box">
                <div class="stat-title">TOTAL REVENUE</div>
                <div class="stat-value" id="totalRevenue">$0</div>
            </div>
        </aside>

        <!-- üéØ MAIN GAME AREA -->
        <main class="main-area">
            <div class="game-card" style="background: var(--pixel-purple); color: var(--bg-dark);">
                <div class="game-card-title" style="color: var(--bg-dark); justify-content: center;">
                    üìÖ YEAR <span id="year">2000</span> - <span id="phase">RETAIL ERA</span>
                </div>
                <div style="font-size: 8px; text-align: center; margin-top: 5px;">
                    <span id="currentProblem">Retail model, early DRM. Indies are invisible.</span>
                </div>
            </div>

            <div class="game-card">
                <div class="game-card-title">üéÆ DEVELOP NEW GAME</div>
                <div id="activeProject" style="display: none;">
                    <div style="background: var(--bg-card-hover); padding: 8px; margin: 10px 0; border: 2px solid var(--border);">
                        <div style="display: flex; justify-content: space-between; font-size: 8px;">
                            <span><strong id="projectName">NO PROJECT</strong></span>
                            <span>PROGRESS: <span id="projectProgress">0%</span></span>
                        </div>
                        <div class="pixel-bar" style="margin-top: 5px;">
                            <div class="pixel-fill progress-fill" id="progressBar" style="width: 0%"></div>
                        </div>
                    </div>
                </div>
                <div class="option-grid">
                    <button class="pixel-button" id="newGameBtn" onclick="openNewGameModal()">
                        NEW GAME
                    </button>
                    <button class="pixel-button" id="continueBtn" style="display: none;" onclick="continueDevelopment()">
                        CONTINUE
                    </button>
                    <button class="pixel-button" onclick="toggleCrunch()">
                        CRUNCH: <span id="crunchStatus">OFF</span>
                    </button>
                    <button class="pixel-button" onclick="takeContract()">
                        CONTRACT
                    </button>
                </div>
            </div>

            <div class="game-card">
                <div class="game-card-title">üìä COMPANY ACTIONS</div>
                <div class="option-grid">
                    <button class="pixel-button" onclick="investMarketing()">
                        MARKETING
                    </button>
                    <button class="pixel-button" onclick="teamBuilding()">
                        TEAM BUILD
                    </button>
                    <button class="pixel-button" onclick="researchAI()">
                        AI RESEARCH
                    </button>
                    <button class="pixel-button" onclick="patentTech()">
                        PATENT TECH
                    </button>
                </div>
            </div>
        </main>

        <!-- üì∞ EVENT PANEL -->
        <aside class="event-panel">
            <div class="game-card-title">üì∞ INDUSTRY NEWS</div>
            <div id="eventLog" style="margin-top: 10px;">
                <div class="event-item">
                    <div class="event-header">2000-01: STUDIO FOUNDED</div>
                    Your journey begins in a small garage...
                </div>
            </div>
        </aside>
    </div>

    <!-- üéÆ NEW GAME MODAL -->
    <div class="modal" id="newGameModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">üéÆ CREATE NEW GAME</div>
                <div class="close-button" onclick="closeNewGameModal()">X</div>
            </div>

            <!-- GENRE SELECTION -->
            <div class="modal-section">
                <h4>üé≤ SELECT GENRE</h4>
                <div class="genre-grid">
                    <button class="option-button" data-type="genre" data-value="action" onclick="selectOption(this)">
                        üéÆ ACTION
                    </button>
                    <button class="option-button" data-type="genre" data-value="rpg" onclick="selectOption(this)">
                        ‚öîÔ∏è RPG
                    </button>
                    <button class="option-button" data-type="genre" data-value="strategy" onclick="selectOption(this)">
                        üó∫Ô∏è STRATEGY
                    </button>
                    <button class="option-button" data-type="genre" data-value="puzzle" onclick="selectOption(this)">
                        üß© PUZZLE
                    </button>
                    <button class="option-button" data-type="genre" data-value="horror" onclick="selectOption(this)">
                        üëª HORROR
                    </button>
                    <button class="option-button" data-type="genre" data-value="simulation" onclick="selectOption(this)">
                        üè≠ SIMULATION
                    </button>
                </div>
            </div>

            <!-- THEME SELECTION -->
            <div class="modal-section">
                <h4>üé® SELECT THEME</h4>
                <div class="theme-grid">
                    <button class="option-button" data-type="theme" data-value="space" onclick="selectOption(this)">
                        üöÄ SPACE
                    </button>
                    <button class="option-button" data-type="theme" data-value="medieval" onclick="selectOption(this)">
                        üè∞ MEDIEVAL
                    </button>
                    <button class="option-button" data-type="theme" data-value="cyberpunk" onclick="selectOption(this)">
                        üåÜ CYBERPUNK
                    </button>
                    <button class="option-button" data-type="theme" data-value="fantasy" onclick="selectOption(this)">
                        ü¶Ñ FANTASY
                    </button>
                    <button class="option-button" data-type="theme" data-value="zombies" onclick="selectOption(this)">
                        üßü ZOMBIES
                    </button>
                    <button class="option-button" data-type="theme" data-value="sports" onclick="selectOption(this)">
                        ‚öΩ SPORTS
                    </button>
                </div>
            </div>

            <!-- PLATFORM SELECTION -->
            <div class="modal-section">
                <h4>üì∫ SELECT PLATFORM</h4>
                <div class="platform-grid">
                    <button class="option-button" data-type="platform" data-value="pc" onclick="selectOption(this)">
                        üíª PC
                    </button>
                    <button class="option-button" data-type="platform" data-value="console" onclick="selectOption(this)">
                        üéÆ CONSOLE
                    </button>
                    <button class="option-button" data-type="platform" data-value="mobile" onclick="selectOption(this)">
                        üì± MOBILE
                    </button>
                    <button class="option-button" data-type="platform" data-value="vr" onclick="selectOption(this)">
                        ü•Ω VR
                    </button>
                </div>
            </div>

            <!-- BUDGET -->
            <div class="modal-section">
                <h4>üí∞ DEVELOPMENT BUDGET</h4>
                <input type="range" id="budgetSlider" min="50000" max="500000" value="150000" 
                       style="width: 100%; height: 10px; background: var(--bg-card); cursor: pointer;"
                       oninput="updateBudget(this.value)">
                <div style="display: flex; justify-content: space-between; margin-top: 8px; font-size: 8px;">
                    <span>MIN: $50K</span>
                    <span id="budgetDisplay">$150K</span>
                    <span>MAX: $500K</span>
                </div>
            </div>

            <div style="display: flex; gap: 10px; margin-top: 15px;">
                <button class="pixel-button" style="flex: 1;" onclick="closeNewGameModal()">CANCEL</button>
                <button class="pixel-button" style="flex: 2;" onclick="startDevelopment()">START DEV</button>
            </div>
        </div>
    </div>

    <!-- üéâ REVIEW MODAL -->
    <div class="modal" id="reviewModal">
        <div class="modal-content review-modal">
            <div class="modal-title">üìä GAME REVIEWS</div>
            <div class="review-score" id="reviewScore">85</div>
            <div class="review-stars" id="reviewStars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÜ</div>
            <div class="review-comments" id="reviewComments">
                "Innovative gameplay and solid execution. A promising start for this studio."
            </div>
            <div style="margin-top: 20px;">
                <div class="stat-box" style="display: inline-block; margin: 5px;">
                    <div class="stat-title">SALES</div>
                    <div class="stat-value" id="salesFigure">$450K</div>
                </div>
                <div class="stat-box" style="display: inline-block; margin: 5px;">
                    <div class="stat-title">UNITS</div>
                    <div class="stat-value" id="unitsSold">50K</div>
                </div>
            </div>
            <button class="pixel-button" style="margin-top: 20px;" onclick="closeReviewModal()">CONTINUE</button>
        </div>
    </div>

    <!-- üèÜ ACHIEVEMENT POPUP -->
    <div class="achievement-popup" id="achievementPopup">
        <div class="achievement-title" id="achievementTitle">UNLOCKED!</div>
        <div class="achievement-desc" id="achievementDesc">New Achievement</div>
    </div>

    <!-- üíæ SAVE INDICATOR -->
    <div class="save-indicator" id="saveIndicator">üíæ SAVING...</div>

    <script>
        // üéÆ GAME STATE
        const gameState = {
            year: 2000,
            month: 1,
            cash: 500000,
            team: 15,
            maxTeam: 50,
            reputation: 65,
            hype: 30,
            morale: 75,
            games: [],
            activeProject: null,
            totalRevenue: 0,
            officeLevel: 1,
            researchLevel: 1,
            crunchMode: false
        };

        // üìä COMBO DATABASE (based on your data trends)
        const gameDB = {
            genres: {
                action: { name: "Action", baseScore: 70, risk: 0.3, trend: [1, 1, 1, 1, 1, 1.2, 1.3, 1.3, 1.2, 1.1] },
                rpg: { name: "RPG", baseScore: 80, risk: 0.5, trend: [1, 1, 1, 1, 1, 1, 1.1, 1.1, 1.2, 1.4] },
                strategy: { name: "Strategy", baseScore: 75, risk: 0.4, trend: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1] },
                puzzle: { name: "Puzzle", baseScore: 65, risk: 0.2, trend: [0.8, 0.8, 0.9, 1, 1, 1.1, 1.2, 1.3, 1.4, 1.5] },
                horror: { name: "Horror", baseScore: 85, risk: 0.6, trend: [1, 1, 1, 1, 1, 1, 1, 1.1, 1.2, 1.3] },
                simulation: { name: "Simulation", baseScore: 60, risk: 0.3, trend: [1, 1, 1, 1, 1, 1, 1.1, 1.1, 1.2, 1.3] }
            },
            themes: {
                space: { name: "Space", multipliers: { action: 1.2, simulation: 1.3, rpg: 1.1 } },
                medieval: { name: "Medieval", multipliers: { rpg: 1.4, strategy: 1.3, action: 1.1 } },
                cyberpunk: { name: "Cyberpunk", multipliers: { rpg: 1.3, action: 1.2, horror: 1.1 } },
                fantasy: { name: "Fantasy", multipliers: { rpg: 1.5, strategy: 1.1, action: 1 } },
                zombies: { name: "Zombies", multipliers: { horror: 1.4, action: 1.2, strategy: 0.8 } },
                sports: { name: "Sports", multipliers: { simulation: 1.3, action: 0.9, puzzle: 0.7 } }
            },
            platforms: {
                pc: { name: "PC", reach: 1.0, cost: 1.0 },
                console: { name: "Console", reach: 1.2, cost: 1.3 },
                mobile: { name: "Mobile", reach: 0.8, cost: 0.6 },
                vr: { name: "VR", reach: 0.3, cost: 1.8 }
            }
        };

        // üé≤ HISTORICAL EVENTS
        const historicalEvents = {
            2004: { type: 'danger', text: 'üí• EA Spouse scandal! Crunch culture exposed. Morale penalty: -20%' },
            2008: { type: 'warning', text: 'üìâ Financial crisis! Market shrinks -30% for 2 years' },
            2012: { type: 'success', text: 'üì± Mobile boom! Mobile games get +50% bonus' },
            2017: { type: 'danger', text: 'üé∞ Loot box controversy! All games risk -15% rep' },
            2020: { type: 'success', text: 'üè† Pandemic boom! Digital sales +200%' },
            2023: { type: 'warning', text: 'üî• Mass layoffs! Talent available -50% cost' }
        };

        // üèÜ ACHIEVEMENTS
        const achievements = {
            firstGame: { name: "FIRST GAME", desc: "Release your first game", unlocked: false },
            hitGame: { name: "HIT GAME", desc: "Score over 85/100", unlocked: false },
            tenGames: { name: "PROLIFIC", desc: "Release 10 games", unlocked: false },
            millionaire: { name: "MILLIONAIRE", desc: "Earn $1M total", unlocked: false }
        };

        // üéÆ INITIALIZE
        document.addEventListener('DOMContentLoaded', () => {
            updateUI();
            loadGame();
            setInterval(autoSave, 60000);
        });

        // üìä UPDATE UI
        function updateUI() {
            document.getElementById('year').textContent = gameState.year;
            document.getElementById('cash').textContent = `$${(gameState.cash / 1000).toFixed(0)}K`;
            document.getElementById('team').textContent = `${gameState.team} / ${gameState.maxTeam}`;
            document.getElementById('reputation').textContent = `${gameState.reputation}%`;
            document.getElementById('hype').textContent = `${gameState.hype}%`;
            document.getElementById('gamesReleased').textContent = gameState.games.length;
            document.getElementById('avgScore').textContent = gameState.games.length ? 
                (gameState.games.reduce((a, b) => a + b.score, 0) / gameState.games.length).toFixed(1) : '‚Äî';
            document.getElementById('totalRevenue').textContent = `$${(gameState.totalRevenue / 1000).toFixed(0)}K`;
            
            // Update phase/problem
            const phases = ["RETAIL", "CRISIS", "INDIE", "MONETIZATION", "LOOTBOX", "LIVE", "RESTRUCTURE"];
            const phaseIndex = Math.floor((gameState.year - 2000) / 4);
            document.getElementById('phase').textContent = `${phases[phaseIndex]} ERA`;
            document.getElementById('currentProblem').textContent = getCurrentProblem();

            // Update active project
            if (gameState.activeProject) {
                document.getElementById('activeProject').style.display = 'block';
                document.getElementById('newGameBtn').style.display = 'none';
                document.getElementById('continueBtn').style.display = 'block';
                document.getElementById('projectName').textContent = 
                    `${gameDB.genres[gameState.activeProject.genre].name} / ${gameDB.themes[gameState.activeProject.theme].name}`;
                document.getElementById('projectProgress').textContent = `${gameState.activeProject.progress}%`;
                document.getElementById('progressBar').style.width = `${gameState.activeProject.progress}%`;
            } else {
                document.getElementById('activeProject').style.display = 'none';
                document.getElementById('newGameBtn').style.display = 'block';
                document.getElementById('continueBtn').style.display = 'none';
            }

            // Check for historical events
            checkHistoricalEvents();
            checkAchievements();
        }

        function getCurrentProblem() {
            const year = gameState.year;
            if (year <= 2004) return "Retail model, early DRM. Indies are invisible.";
            if (year <= 2008) return "Rising costs, creative crisis. Crunch begins.";
            if (year <= 2012) return "Digital distribution rises. Indies emerge.";
            if (year <= 2017) return "Microtransactions dominate. Creative risk drops.";
            if (year <= 2020) return "Live service games rule. AAA identity crisis.";
            return "Mass layoffs. Indies & AA save the industry.";
        }

        // üéÆ GAME ACTIONS
        function openNewGameModal() {
            if (gameState.activeProject) {
                alert('Finish current project first!');
                return;
            }
            document.getElementById('newGameModal').classList.add('active');
        }

        function closeNewGameModal() {
            document.getElementById('newGameModal').classList.remove('active');
            document.querySelectorAll('.option-button').forEach(btn => btn.classList.remove('selected'));
        }

        function selectOption(btn) {
            const type = btn.dataset.type;
            document.querySelectorAll(`[data-type="${type}"]`).forEach(b => b.classList.remove('selected'));
            btn.classList.add('selected');
        }

        function updateBudget(value) {
            document.getElementById('budgetDisplay').textContent = `$${(value / 1000).toFixed(0)}K`;
        }

        function startDevelopment() {
            const genre = document.querySelector('[data-type="genre"].selected')?.dataset.value;
            const theme = document.querySelector('[data-type="theme"].selected')?.dataset.value;
            const platform = document.querySelector('[data-type="platform"].selected')?.dataset.value;
            const budget = parseInt(document.getElementById('budgetSlider').value);

            if (!genre || !theme || platform) {
                alert('Please select genre, theme, and platform!');
                return;
            }

            if (gameState.cash < budget) {
                alert('Not enough cash!');
                return;
            }

            gameState.cash -= budget;
            gameState.activeProject = {
                genre, theme, platform, budget,
                progress: 0, quality: 0,
                startYear: gameState.year
            };

            closeNewGameModal();
            updateUI();
            addEvent('info', `Started development: ${gameDB.genres[genre].name} / ${gameDB.themes[theme].name}`);
        }

        function continueDevelopment() {
            if (!gameState.activeProject) return;

            const project = gameState.activeProject;
            const devSpeed = gameState.crunchMode ? 25 : 15;
            const moralePenalty = gameState.crunchMode ? 3 : 0;

            project.progress += devSpeed;
            gameState.morale = Math.max(0, gameState.morale - moralePenalty);

            // Random development events
            if (Math.random() < 0.1) triggerDevEvent();

            if (project.progress >= 100) {
                releaseGame();
            }

            updateUI();
        }

        function triggerDevEvent() {
            const events = [
                { type: 'warning', text: 'Critical bug found! Progress -10%', effect: () => { gameState.activeProject.progress -= 10; } },
                { type: 'success', text: 'Star programmer joins! Progress +15%', effect: () => { gameState.activeProject.progress += 15; } },
                { type: 'info', text: 'Design breakthrough! Quality +5', effect: () => { gameState.activeProject.quality += 5; } }
            ];
            const event = events[Math.floor(Math.random() * events.length)];
            event.effect();
            addEvent(event.type, event.text);
        }

        function releaseGame() {
            const project = gameState.activeProject;
            const score = calculateScore(project);
            const sales = calculateSales(project, score);

            // Update state
            gameState.cash += sales;
            gameState.totalRevenue += sales;
            gameState.games.push({
                ...project,
                score,
                sales,
                releaseYear: gameState.year
            });

            // Update reputation
            const repChange = score > 80 ? 8 : score > 60 ? 3 : -5;
            gameState.reputation = Math.max(0, Math.min(100, gameState.reputation + repChange));

            // Reset hype
            gameState.hype = Math.max(10, gameState.hype - 30);

            // Morale boost for success
            gameState.morale = Math.min(100, gameState.morale + 10);

            // Clear project
            gameState.activeProject = null;

            // Show review
            showReview(score, sales);

            // Post-launch events
            if (score > 80 && Math.random() < 0.3) {
                const dlcRevenue = sales * 0.2;
                gameState.cash += dlcRevenue;
                gameState.totalRevenue += dlcRevenue;
                addEvent('success', `DLC released! +$${(dlcRevenue / 1000).toFixed(0)}K`);
            }

            updateUI();
        }

        function calculateScore(project) {
            const genre = gameDB.genres[project.genre];
            const theme = gameDB.themes[project.theme];
            const platform = gameDB.platforms[project.platform];
            const yearTrend = genre.trend[Math.min(9, Math.floor((gameState.year - 2000) / 3))];

            let score = genre.baseScore * yearTrend;
            score *= (theme.multipliers[project.genre] || 1.0);
            score *= (project.budget / 100000) * 0.5 + 0.5;
            score *= (gameState.reputation / 100);
            score *= (gameState.morale / 100) * 0.5 + 0.5;
            score *= 0.8 + Math.random() * 0.4; // Random factor
            
            return Math.min(100, Math.max(0, score));
        }

        function calculateSales(project, score) {
            const base = project.budget * 3;
            const scoreBonus = (score - 50) / 50;
            const hypeBonus = gameState.hype / 100;
            const yearTrend = gameState.year < 2010 ? 0.8 : gameState.year < 2020 ? 1.0 : 1.2;
            
            return Math.floor(base * (1 + scoreBonus) * (1 + hypeBonus) * yearTrend);
        }

        function showReview(score, sales) {
            document.getElementById('reviewScore').textContent = score.toFixed(0);
            document.getElementById('reviewStars').textContent = '‚òÖ'.repeat(Math.floor(score / 20)) + '‚òÜ'.repeat(5 - Math.floor(score / 20));
            document.getElementById('salesFigure').textContent = `$${(sales / 1000).toFixed(0)}K`;
            document.getElementById('unitsSold').textContent = `${(sales / 10).toFixed(0)}K`;
            
            const comments = score >= 90 ? "A masterpiece! Game of the year!" :
                           score >= 80 ? "Excellent game! Must buy!" :
                           score >= 70 ? "Good game with some flaws." :
                           score >= 60 ? "Average experience." :
                           "Disappointing. Needs improvement.";
            document.getElementById('reviewComments').textContent = comments;
            
            document.getElementById('reviewModal').classList.add('active');
        }

        function closeReviewModal() {
            document.getElementById('reviewModal').classList.remove('active');
        }

        // üíº COMPANY ACTIONS
        function hireStaff() {
            const cost = 50000;
            if (gameState.cash >= cost && gameState.team < gameState.maxTeam) {
                gameState.cash -= cost;
                gameState.team++;
                gameState.morale = Math.min(100, gameState.morale + 5);
                addEvent('success', 'New staff hired! +1 team, +5 morale');
                updateUI();
            } else {
                alert(gameState.team >= gameState.maxTeam ? 'Max team size!' : 'Not enough cash!');
            }
        }

        function investMarketing() {
            const cost = 30000;
            if (gameState.cash >= cost) {
                gameState.cash -= cost;
                gameState.hype = Math.min(100, gameState.hype + 25);
                addEvent('info', 'Marketing campaign launched! +25 hype');
                updateUI();
            } else {
                alert('Not enough cash!');
            }
        }

        function researchTech() {
            const cost = 75000;
            if (gameState.cash >= cost) {
                gameState.cash -= cost;
                gameState.researchLevel++;
                addEvent('success', `Research completed! Level ${gameState.researchLevel} unlocked`);
                updateUI();
            } else {
                alert('Not enough cash!');
            }
        }

        function moveOffice() {
            const cost = 150000;
            const level = gameState.officeLevel;
            if (gameState.cash >= cost && level < 5) {
                gameState.cash -= cost;
                gameState.officeLevel++;
                gameState.maxTeam += 25;
                gameState.morale = Math.min(100, gameState.morale + 20);
                addEvent('success', `Office upgraded! Level ${gameState.officeLevel}, +25 max team`);
                updateUI();
            } else {
                alert(level >= 5 ? 'Max office level!' : 'Not enough cash!');
            }
        }

        function toggleCrunch() {
            gameState.crunchMode = !gameState.crunchMode;
            document.getElementById('crunchStatus').textContent = gameState.crunchMode ? 'ON' : 'OFF';
            addEvent('warning', `Crunch mode ${gameState.crunchMode ? 'enabled' : 'disabled'}`);
        }

        function takeContract() {
            const revenue = 40000;
            gameState.cash += revenue;
            gameState.totalRevenue += revenue;
            addEvent('info', `Contract work completed! +$${revenue / 1000}K`);
            updateUI();
        }

        function teamBuilding() {
            const cost = 20000;
            if (gameState.cash >= cost) {
                gameState.cash -= cost;
                gameState.morale = Math.min(100, gameState.morale + 15);
                addEvent('success', 'Team building event! +15 morale');
                updateUI();
            } else {
                alert('Not enough cash!');
            }
        }

        function researchAI() {
            alert('Feature coming soon!');
        }

        function patentTech() {
            alert('Feature coming soon!');
        }

        // üìú EVENT LOG
        function addEvent(type, text) {
            const eventLog = document.getElementById('eventLog');
            const event = document.createElement('div');
            event.className = `event-item ${type}`;
            event.innerHTML = `
                <div class="event-header">${gameState.year}-${gameState.month.toString().padStart(2, '0')}</div>
                ${text}
            `;
            eventLog.insertBefore(event, eventLog.firstChild);
            while (eventLog.children.length > 10) eventLog.removeChild(eventLog.lastChild);
        }

        // üèÜ ACHIEVEMENTS
        function checkAchievements() {
            if (gameState.games.length === 1 && !achievements.firstGame.unlocked) {
                unlockAchievement(achievements.firstGame);
            }
            if (gameState.games.length >= 10 && !achievements.tenGames.unlocked) {
                unlockAchievement(achievements.tenGames);
            }
            if (gameState.totalRevenue >= 1000000 && !achievements.millionaire.unlocked) {
                unlockAchievement(achievements.millionaire);
            }
            const hit = gameState.games.find(g => g.score >= 85);
            if (hit && !achievements.hitGame.unlocked) {
                unlockAchievement(achievements.hitGame);
            }
        }

        function unlockAchievement(achievement) {
            achievement.unlocked = true;
            document.getElementById('achievementTitle').textContent = achievement.name;
            document.getElementById('achievementDesc').textContent = achievement.desc;
            document.getElementById('achievementPopup').classList.add('active');
            setTimeout(() => {
                document.getElementById('achievementPopup').classList.remove('active');
            }, 3000);
            addEvent('success', `üèÜ Achievement: ${achievement.name}`);
        }

        // üìÖ HISTORICAL EVENTS
        function checkHistoricalEvents() {
            const event = historicalEvents[gameState.year];
            if (event && gameState.month === 1) {
                addEvent(event.type, event.text);
                
                // Apply event effects
                if (gameState.year === 2004) gameState.morale = Math.max(0, gameState.morale - 20);
                if (gameState.year === 2008) {
                    // Market shrink for 2 years
                }
                if (gameState.year === 2020) {
                    const bonus = 200000;
                    gameState.cash += bonus;
                    gameState.totalRevenue += bonus;
                }
            }
        }

        // üíæ SAVE/LOAD
        function autoSave() {
            localStorage.setItem('industrySimSave', JSON.stringify(gameState));
            showSaveIndicator();
        }

        function loadGame() {
            const saved = localStorage.getItem('industrySimSave');
            if (saved) {
                Object.assign(gameState, JSON.parse(saved));
                updateUI();
            }
        }

        function showSaveIndicator() {
            const indicator = document.getElementById('saveIndicator');
            indicator.classList.add('show');
            setTimeout(() => indicator.classList.remove('show'), 1000);
        }

        // üéÆ KEYBOARD CONTROLS
        document.addEventListener('keydown', (e) => {
            if (e.code === 'Space' && gameState.activeProject) {
                e.preventDefault();
                continueDevelopment();
            }
        });
    </script>
</body>
</html>
</html>
</body>
</html>
